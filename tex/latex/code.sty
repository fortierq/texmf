\usepackage{minted}

\newcommand{\cpp}[1]{\mintinline{c}{#1}}
\newcommand{\ocaml}[1]{\mintinline{ocaml}{#1}}
\newcommand{\python}[1]{\mintinline{python}{#1}}
\newcommand{\sql}[1]{\mintinline{sql}{#1}}

\usepackage{mdframed}
\newmdenv[
  topline=false,
  bottomline=false,
  rightline=false,
  skipabove=\topsep,
  skipbelow=\topsep
]{emphase}

\makeatletter
\newenvironment{code}[2][\small]
 {\RecustomVerbatimEnvironment{Verbatim}{BVerbatim}{numbers=none}%
  \def\FV@BProcessLine##1{%
    \hbox{%
      \FancyVerbFormatLine{##1}%
    }%
  }%
  \VerbatimEnvironment
  \setbox\z@=\hbox\bgroup
  \begin{minted}[tabsize=4, breaklines, linenos=false, fontfamily=tt, fontsize=#1, escapeinside=§§]{#2}}
 {\end{minted}\egroup
  \leavevmode\vbox{\hrule\kern2mm\box\z@\kern2mm\hrule}}
\makeatother

\makeatletter
\newenvironment{barecode}[2][\small]
 {\RecustomVerbatimEnvironment{Verbatim}{BVerbatim}{numbers=none}%
  \def\FV@BProcessLine##1{%
    \hbox{%
      \FancyVerbFormatLine{##1}%
    }%
  }%
  \VerbatimEnvironment
  \setbox\z@=\hbox\bgroup
  \begin{minted}[breaklines, linenos=false, fontfamily=tt, fontsize=#1, escapeinside=§§]{#2}}
 {\end{minted}\egroup
  \leavevmode\vbox{\kern2mm\box\z@\kern2mm}}
\makeatother

\newcommand{\icode}[1]{\begin{center}
    \fbox{\includegraphics[scale = .23]{#1}}
\end{center}}

\newcommand{\hoare}[3]{\{\ocaml{#1}\} \ocaml{#2} \{\ocaml{#3}\}}

\usepackage[french,vlined]{algorithm2e}
\DontPrintSemicolon
\SetKwIF{Si}{SinonSi}{Sinon}{Si}{:}{Sinon si}{Sinon}{Fin\ Si}
\SetKwBlock{Debut}{Début algorithme}{Fin\ algorithme}
\SetKwFor{Pour}{Pour}{:}{Fin\ Pour}
\SetKwFor{TantQue}{Tant que}{:}{Fin\ Tant\ que}
\SetKw{Renv}{Renvoyer}
\SetKwInOut{Entree}{Entrée}
\SetKwInOut{Sortie}{Sortie}
\SetArgSty{textup}
\SetKwProg{Fn}{Fonction}{}{}

\usepackage[most]{tcolorbox}

\newtcolorbox{algonotitle}[1]{colback=black!2!white, coltitle=black, width=#1, sharp corners, boxrule=.5pt, leftrule=.5pt, enhanced}

\newtcolorbox{algo}[2]{colback=black!2!white, coltitle=black, title={#1}, width=#2, sharp corners, boxrule=.5pt, leftrule=.5pt, attach boxed title to top center={yshift=0mm, xshift=0mm}, enhanced, 
boxed title style={
    colback=black!2!white,
    colframe=black,
    boxrule=0.5pt,
    bottomrule=0pt,
    sharp corners
},
}

\newtcolorbox{algolang}[3]{colback=black!2!white, coltitle=black, title=#1, width=#2, sharp corners, boxrule=.5pt, leftrule=.5pt, attach boxed title to top center={yshift=0mm, xshift=0mm}, enhanced, 
boxed title style={
    colback=black!2!white,
    colframe=black,
    boxrule=0.5pt,
    bottomrule=0pt,
    sharp corners
},
underlay={
        \node[draw, minimum width=1cm,minimum height=0.5cm,outer sep=auto,
        anchor=north east,fill=white] at (interior.north east)
        {\small \cpp{#3}};
        }
}

\newcommand{\inputalgo}[4]{
  \begin{center}
    \begin{algolang}{#1}{#2}{#3}
        \inputminted[tabsize=4, linenos=false, fontfamily=tt, fontsize=\small, escapeinside=§§]{#3}{#4}
    \end{algolang}
  \end{center}
}

\newenvironment{algo2}[2]{
  \begin{center}
    \begin{algo}{#1}{#2}
        \begin{algorithm}[H]
} {
        \end{algorithm}
    \end{algo}
  \end{center}
}

\newenvironment{algonotitle2}[1]{
  \begin{center}
    \begin{algonotitle}{#1}
        \begin{algorithm}[H]
} {
        \end{algorithm}
    \end{algonotitle}
  \end{center}
}
